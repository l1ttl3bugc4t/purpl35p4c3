#!/bin/bash
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# โ  ๐พ purpl35p4c3 โข herramienta ofensiva by l1ttl3bugc4t ๐    โ
# โ  script: rdp_check.sh                                   โ
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

#!/bin/bash
# Escaneo de RDP (puerto 3389)
# Elaborado por Respuesta y Recuperaciรณn ๐ก๏ธ
TARGET=$1
if [ -z "$TARGET" ]; then
  echo "Uso: $0 <IP o dominio>"
  exit 1
fi
OUTPUT_DIR="rdp_recon_$TARGET"
mkdir -p "$OUTPUT_DIR"
REPORT="$OUTPUT_DIR/rdp_reporte.txt"
DATE=$(date)
echo "REPORTE DE ESCANEO RDP - $DATE" > "$REPORT"
echo "Objetivo: $TARGET" >> "$REPORT"
echo "-----------------------------------------" >> "$REPORT"
echo "[+] Escaneando puerto 3389..."
nmap -Pn -p3389 -sV "$TARGET" -oN "$OUTPUT_DIR/nmap_3389.txt"
echo ">>> NMAP 3389 <<<" >> "$REPORT"
grep -iE "3389.*open|ms-wbt-server" "$OUTPUT_DIR/nmap_3389.txt" >> "$REPORT"
echo >> "$REPORT"
echo "[+] Enumerando cifrado RDP (rdp-enum-encryption)..."
nmap -Pn -p3389 --script rdp-enum-encryption "$TARGET" -oN "$OUTPUT_DIR/rdp_enum_encryption.txt"
echo ">>> CIFRADO RDP <<<" >> "$REPORT"
grep -iE "Security layer|RDP Encryption" "$OUTPUT_DIR/rdp_enum_encryption.txt" >> "$REPORT"
echo >> "$REPORT"
echo "[+] Enumerando info de sistema NTLM (rdp-ntlm-info)..."
nmap -Pn -p3389 --script rdp-ntlm-info "$TARGET" -oN "$OUTPUT_DIR/rdp_ntlm_info.txt"
echo ">>> INFO DEL SISTEMA (NTLM) <<<" >> "$REPORT"
grep -iE "OS|Name|Domain" "$OUTPUT_DIR/rdp_ntlm_info.txt" >> "$REPORT"
echo >> "$REPORT"
echo "[*] Reporte generado en: $REPORT"
cat "$REPORT"
